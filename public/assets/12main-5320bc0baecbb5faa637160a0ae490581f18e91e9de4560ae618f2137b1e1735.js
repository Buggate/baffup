var main=function(e){var i={settings:{preload:!1,slideDuration:500,layoutDuration:750,thumbnailsPerRow:2,mainSide:"right"},$window:null,$body:null,$main:null,$thumbnails:null,$viewer:null,$toggle:null,$navNext:null,$navPrevious:null,slides:[],current:null,locked:!1,keys:{27:function(){i.toggle()},38:function(){i.up()},40:function(){i.down()},32:function(){i.next()},39:function(){i.next()},37:function(){i.previous()}},initProperties:function(){i.$window=e(window),i.$body=e("body"),i.$thumbnails=e("#thumbnails"),i.$viewer=e('<div id="viewer"><div class="inner"><div class="nav-next"></div><div class="nav-previous"></div><div class="toggle"></div></div></div>').appendTo(i.$body),i.$navNext=i.$viewer.find(".nav-next"),i.$navPrevious=i.$viewer.find(".nav-previous"),i.$main=e("#main"),e('<div class="toggle"></div>').appendTo(i.$main),i.$toggle=e(".toggle"),skel.vars.IEVersion<9&&i.$window.on("resize",function(){window.setTimeout(function(){i.$viewer.css("width",i.$window.width()-i.$main.width())},100)}).trigger("resize")},initEvents:function(){i.$window.on("load",function(){i.$body.removeClass("is-loading-0"),window.setTimeout(function(){i.$body.removeClass("is-loading-1")},100),window.setTimeout(function(){i.$body.removeClass("is-loading-2")},100+Math.max(i.settings.layoutDuration-150,0))});var e;i.$window.on("resize",function(){i.$body.addClass("is-loading-0"),window.clearTimeout(e),e=window.setTimeout(function(){i.$body.removeClass("is-loading-0")},100)}),i.$viewer.on("touchend",function(){skel.breakpoint("medium").active&&i.hide()}),i.$viewer.on("touchstart",function(e){i.$viewer.touchPosX=e.originalEvent.touches[0].pageX,i.$viewer.touchPosY=e.originalEvent.touches[0].pageY}).on("touchmove",function(e){if(null!==i.$viewer.touchPosX&&null!==i.$viewer.touchPosY){var n=i.$viewer.touchPosX-e.originalEvent.touches[0].pageX,o=i.$viewer.touchPosY-e.originalEvent.touches[0].pageY;boundary=20,delta=50,o<boundary&&o>-1*boundary&&n>delta?i.next():o<boundary&&o>-1*boundary&&n<-1*delta&&i.previous();var t=i.$viewer.outerHeight(),s=i.$viewer.get(0).scrollHeight-i.$viewer.scrollTop();(i.$viewer.scrollTop()<=0&&o<0||s>t-2&&s<t+2&&o>0)&&(e.preventDefault(),e.stopPropagation())}}),i.$main.on("touchstart",function(e){skel.breakpoint("xsmall").active||(i.$main.touchPosX=e.originalEvent.touches[0].pageX,i.$main.touchPosY=e.originalEvent.touches[0].pageY)}).on("touchmove",function(e){if(!skel.breakpoint("xsmall").active&&null!==i.$main.touchPosX&&null!==i.$main.touchPosY){var n=i.$main.touchPosX-e.originalEvent.touches[0].pageX,o=i.$main.touchPosY-e.originalEvent.touches[0].pageY;switch(boundary=20,delta=50,result=!1,i.settings.mainSide){case"left":result=o<boundary&&o>-1*boundary&&n>delta;break;case"right":result=o<boundary&&o>-1*boundary&&n<-1*delta}result&&i.hide();var t=i.$main.outerHeight(),s=i.$main.get(0).scrollHeight-i.$main.scrollTop();(i.$main.scrollTop()<=0&&o<0||s>t-2&&s<t+2&&o>0)&&(e.preventDefault(),e.stopPropagation())}}),i.$toggle.on("click",function(){i.toggle()}),i.$toggle.on("touchend",function(e){e.stopPropagation()}),i.$navNext.on("click",function(){i.next()}),i.$navPrevious.on("click",function(){i.previous()}),i.$body.on("keydown","input,select,textarea",function(e){e.stopPropagation()}),i.$window.on("keydown",function(e){skel.breakpoint("xsmall").active||e.keyCode in i.keys&&(e.stopPropagation(),e.preventDefault(),i.keys[e.keyCode]())})},initViewer:function(){i.$thumbnails.on("click",".thumbnail",function(n){var o=e(this);n.preventDefault(),n.stopPropagation(),i.locked&&o.blur(),i.switchTo(o.data("index"))}),i.$thumbnails.children().each(function(){var n,o=e(this),t=o.children(".thumbnail");if(n={$parent:o,$slide:null,$slideImage:null,$slideCaption:null,url:t.attr("href"),loaded:!1},o.attr("tabIndex","-1"),n.$slide=e('<div class="slide"><div class="caption"></div><div class="image"></div></div>'),n.$slideImage=n.$slide.children(".image"),n.$slideImage.css("background-image","").css("background-position",t.data("position")||"center"),n.$slideCaption=n.$slide.find(".caption"),o.children().not(t).appendTo(n.$slideCaption),i.settings.preload){e('<img src="'+n.url+'" />');n.$slideImage.css("background-image","url("+n.url+")"),n.$slide.addClass("loaded"),n.loaded=!0}i.slides.push(n),t.data("index",i.slides.length-1)})},init:function(){skel.vars.IEVersion<10&&(i.settings.slideDuration=0,i.settings.layoutDuration=0),skel.breakpoints({xlarge:"(max-width: 1680px)",large:"(max-width: 1280px)",medium:"(max-width: 980px)",small:"(max-width: 736px)",xsmall:"(max-width: 480px)"}),i.initProperties(),i.initViewer(),i.initEvents(),window.setTimeout(function(){skel.on("-xsmall !xsmall",function(){null===i.current&&i.switchTo(0,!0)})},0)},switchTo:function(n,o){if((i.current!=n||skel.breakpoint("xsmall").active)&&!i.locked){i.locked=!0,!o&&skel.breakpoint("medium").active&&skel.vars.IEVersion>8&&i.hide();var t=null!==i.current?i.slides[i.current]:null,s=i.slides[n];i.current=n,t&&(t.$parent.removeClass("active"),t.$slide.removeClass("active")),s.$parent.addClass("active").focus();var a=function(){t&&t.$slide.detach(),s.$slide.appendTo(i.$viewer),s.loaded?window.setTimeout(function(){s.$slide.addClass("active"),window.setTimeout(function(){i.locked=!1},100)},100):window.setTimeout(function(){s.$slide.addClass("loading"),e('<img src="'+s.url+'" />').on("load",function(){s.$slideImage.css("background-image","url("+s.url+")"),s.loaded=!0,s.$slide.removeClass("loading"),s.$slide.addClass("active"),window.setTimeout(function(){i.locked=!1},100)})},100)};t?window.setTimeout(a,i.settings.slideDuration):a()}},next:function(){var e,n=i.current;e=n>=i.slides.length-1?0:n+1,i.switchTo(e)},previous:function(){var e,n=i.current,o=i.slides.length;e=n<=0?o-1:n-1,i.switchTo(e)},up:function(){if(!i.$body.hasClass("fullscreen")){var e,n=i.current,o=i.slides.length,t=i.settings.thumbnailsPerRow;e=n<=t-1?o-(t-1-n)-1:n-t,i.switchTo(e)}},down:function(){if(!i.$body.hasClass("fullscreen")){var e,n=i.current,o=i.slides.length,t=i.settings.thumbnailsPerRow;e=n>=o-t?n-o+t:n+t,i.switchTo(e)}},show:function(){i.$body.hasClass("fullscreen")&&(i.$body.removeClass("fullscreen"),i.$main.focus())},hide:function(){i.$body.hasClass("fullscreen")||(i.$body.addClass("fullscreen"),i.$main.blur())},toggle:function(){i.$body.hasClass("fullscreen")?i.show():i.hide()}};return i}(jQuery);main.init();